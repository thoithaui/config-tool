Để chạy một file Python như một dịch vụ trên Windows, bạn có thể sử dụng một số công cụ như pywin32 hoặc pyinstaller kết hợp với NSSM (Non-Sucking Service Manager). Dưới đây là các bước để thực hiện điều này:
1.	Cài đặt pywin32 và NSSM: Trước tiên, cài đặt pywin32 bằng cách chạy lệnh sau trong Command Prompt hoặc PowerShell:
Copy code
pip install pywin32 
Tiếp theo, tải xuống NSSM từ trang web chính thức của nó: https://nssm.cc/download. Giải nén và lưu trữ NSSM trong một thư mục dễ truy cập.
2.	Tạo file Python script: Tạo một file Python script (.py) với mã nguồn của ứng dụng bạn muốn chạy như một dịch vụ.
3.	Tạo dịch vụ bằng NSSM: Mở Command Prompt hoặc PowerShell với quyền quản trị và chạy lệnh sau:
swiftCopy code
path\to\nssm.exe install ServiceName "path\to\python.exe" "path\to\your_script.py" 
Trong đó:
•	ServiceName là tên của dịch vụ bạn muốn tạo.
•	path\to\python.exe là đường dẫn đến trình thông dịch Python.
•	path\to\your_script.py là đường dẫn đến file Python script của bạn.
4.	Cấu hình dịch vụ: Sử dụng lệnh sau để cấu hình dịch vụ:
swiftCopy code
path\to\nssm.exe set ServiceName AppParameters "path\to\your_script.py" 
Trong đó:
•	ServiceName là tên của dịch vụ bạn muốn cấu hình.
•	path\to\your_script.py là đường dẫn đến file Python script của bạn.
5.	Khởi động dịch vụ: Sử dụng lệnh sau để khởi động dịch vụ:
cssCopy code
path\to\nssm.exe start ServiceName 
Trong đó ServiceName là tên của dịch vụ bạn muốn khởi động.

Để thực hiện điều này, bạn có thể sử dụng một số công cụ như PyInstaller hoặc cx_Freeze. Dưới đây là các bước để build một folder thành file exe và cấu hình file exe để chạy file main.py:
1.	Cài đặt công cụ build: Trước tiên, bạn cần cài đặt công cụ build như PyInstaller hoặc cx_Freeze. Sử dụng pip để cài đặt:
Copy code
pip install pyinstaller 
hoặc
Copy code
pip install cx-Freeze 
2.	Chuẩn bị folder chứa mã nguồn: Tạo một folder chứa các file Python và tệp tin liên quan khác (nếu có). File Python chính (ví dụ: main.py) sẽ là điểm bắt đầu khi chạy file exe.
3.	Build file exe: Sử dụng công cụ build (PyInstaller hoặc cx_Freeze) để build folder thành file exe. Ví dụ, với PyInstaller, bạn có thể chạy lệnh sau trong Command Prompt hoặc PowerShell:
cssCopy code
pyinstaller --onefile --name myapp path/to/main.py 
Trong đó myapp là tên của file exe bạn muốn tạo, và path/to/main.py là đường dẫn đến file Python chính (main.py) trong folder của bạn.
4.	Kết quả: Sau khi quá trình build hoàn tất, công cụ sẽ tạo file exe trong thư mục đích, bao gồm các tệp tin và thư mục liên quan. Bạn có thể chạy file exe này và nó sẽ mặc định chạy file main.py.
Lưu ý rằng quá trình build có thể tùy chỉnh nhiều hơn, ví dụ như thêm các tùy chọn cho icon, version, dependencies, và nhiều hơn nữa. Hãy tham khảo tài liệu và hướng dẫn chi tiết của công cụ build bạn chọn để biết thêm thông tin về các tùy chọn và cấu hình khác.

metricbeat modules disable --all
